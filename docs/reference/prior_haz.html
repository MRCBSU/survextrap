<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The spline model in survextrap allows the hazard to change over time in an
arbitrarily flexible manner.  The prior distributions on the parameters of
this model have implications for how much we expect the hazard to plausibly
vary over time.  These priors are hard to interpret directly, but this
function can be used to compute their implications on a more
easily-understandable scale."><title>Compute consequences of priors chosen for a flexible hazard model in
survextrap, in terms of a standard deviation measuring the
variability over time of the hazard function or the hazard ratio
function. — prior_haz • survextrap</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute consequences of priors chosen for a flexible hazard model in
survextrap, in terms of a standard deviation measuring the
variability over time of the hazard function or the hazard ratio
function. — prior_haz"><meta property="og:description" content="The spline model in survextrap allows the hazard to change over time in an
arbitrarily flexible manner.  The prior distributions on the parameters of
this model have implications for how much we expect the hazard to plausibly
vary over time.  These priors are hard to interpret directly, but this
function can be used to compute their implications on a more
easily-understandable scale."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">survextrap</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/examples.html">Examples of using survextrap</a>
    <a class="dropdown-item" href="../articles/methods.html">Details of methods behind survextrap</a>
    <a class="dropdown-item" href="../articles/priors.html">Priors in survextrap models</a>
    <a class="dropdown-item" href="../articles/waning.html">Treatment effect waning in survextrap</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/chjackson/survextrap/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Compute consequences of priors chosen for a flexible hazard model in
survextrap, in terms of a standard deviation measuring the
variability over time of the hazard function or the hazard ratio
function.</h1>
      <small class="dont-index">Source: <a href="https://github.com/chjackson/survextrap/blob/HEAD/R/priors.R" class="external-link"><code>R/priors.R</code></a></small>
      <div class="d-none name"><code>prior_haz.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The spline model in survextrap allows the hazard to change over time in an
arbitrarily flexible manner.  The prior distributions on the parameters of
this model have implications for how much we expect the hazard to plausibly
vary over time.  These priors are hard to interpret directly, but this
function can be used to compute their implications on a more
easily-understandable scale.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">prior_haz_sd</span><span class="op">(</span></span>
<span>  <span class="va">mspline</span>,</span>
<span>  coefs_mean <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prior_smooth <span class="op">=</span> <span class="fu"><a href="priors.html">p_gamma</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  prior_loghaz <span class="op">=</span> <span class="fu"><a href="priors.html">p_normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>  prior_loghr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  X <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nonprop <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  prior_sdnp <span class="op">=</span> <span class="fu"><a href="priors.html">p_gamma</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  tmin <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  tmax <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  nsim <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  hq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>  quantiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">prior_hr_sd</span><span class="op">(</span></span>
<span>  <span class="va">mspline</span>,</span>
<span>  coefs_mean <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prior_smooth <span class="op">=</span> <span class="fu"><a href="priors.html">p_gamma</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  prior_loghaz <span class="op">=</span> <span class="fu"><a href="priors.html">p_normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>  prior_loghr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  X <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  X0 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nonprop <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  prior_sdnp <span class="op">=</span> <span class="fu"><a href="priors.html">p_gamma</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  tmin <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  tmax <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  nsim <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  quantiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>mspline</dt>
<dd><p>A list of control parameters defining the spline model.</p>
<p><code>iknots</code>: Internal knots.  If this is not supplied, then the number of
knots is taken from <code>df</code>, and their location is taken from equally-spaced
quantiles of the observed event times (concatenated with the distinct
follow-up times in the external data).</p>
<p><code>bknots</code>: Boundary knots.  If this is not supplied, the boundary knots are
set to zero and the maximum event time (including the follow-up times in
the external data).</p>
<p><code>df</code>: Degrees of freedom, i.e. the number of parameters (or basis terms)
that define the hazard as a spline function of time.  Defaults to 10.  Note
this does not necessarily overfit because the function is smoothed through
the prior.</p>
<p><code>degree</code>: Polynomial degree used for the basis function. The default is 3, giving a cubic.</p></dd>


<dt>coefs_mean</dt>
<dd><p>Spline basis coefficients that define the prior mean for the hazard function. By
default, these are set to values that define a constant hazard function.  They are normalised to
sum to 1 internally (if they do not already).</p></dd>


<dt>prior_smooth</dt>
<dd><p>Gamma prior for the smoothing standard deviation, in
models where this is estimated.  This should be a call to <code><a href="priors.html">p_gamma()</a></code>.  The
default is <code>p_gamma(2,1)</code>.</p></dd>


<dt>prior_loghaz</dt>
<dd><p>Prior for the baseline log rate parameter (<code>log(eta)</code>), after centering around the log
crude event rate in the data.
This should be a call to a prior constructor function, such as
<code>p_normal(0,1)</code> or <code>p_t(0,2,2)</code>.   Supported prior distribution families
are normal (parameters mean and SD) and t distributions (parameters
location, scale and degrees of freedom).  The default is a normal distribution with
mean 0 and standard deviation 20.</p>
<p>"Baseline" is defined
by the continuous covariates taking a value of zero and factor covariates taking their
reference level.  To use a different baseline, the data should be transformed
appropriately beforehand, so that a value of zero has a different meaning.</p>
<p>For continuous covariates, it helps for both computation and interpretation to define the value of zero to
denote a typical value in the data, e.g. the mean.</p></dd>


<dt>prior_loghr</dt>
<dd><p>Priors for log hazard ratios.  This should be a call to
<code><a href="priors.html">p_normal()</a></code> or <code><a href="priors.html">p_t()</a></code>.  A list of calls can also be provided, to give
different priors to different coefficients, where the name
of each list component matches the name of the coefficient, e.g.
<code>list("age45-59" = p_normal(0,1), "age60+" = p_t(0,2,3))</code></p>
<p>The default is <code>p_normal(0,2.5)</code> for all coefficients.</p></dd>


<dt>x</dt>
<dd><p>Only required for models with covariates.  A list with components <code>ncovs</code> (number of covariates)
and <code>xnames</code> (names of these covariates).</p></dd>


<dt>X</dt>
<dd><p>Either a list, vector or one-row matrix with one covariate value.
Factors must be supplied as multiple numeric (0/1) contrasts. (TODO doc on how to build
the names - vignette)</p></dd>


<dt>nonprop</dt>
<dd><p>If <code>TRUE</code> then a non-proportional hazards model is fitted.
This is achieved by modelling the spline basis weights in terms of the covariates.  See
the "methods" vignette for more details.   In models with multiple covariates, currently
there is no way to assume that some covariates have proportional hazards but others don't -
it is all or none.</p></dd>


<dt>prior_sdnp</dt>
<dd><p>Prior for the standard deviation parameters that smooth the non-proportionality
effects over time in non-proportional hazards models.  This should be a call to <code><a href="priors.html">p_gamma()</a></code>
or a list of calls to <code><a href="priors.html">p_gamma()</a></code> with one component per covariate, as in <code>prior_loghr</code>.</p></dd>


<dt>tmin</dt>
<dd><p>Minimum plotting time.  Defaults to lower boundary knot.</p></dd>


<dt>tmax</dt>
<dd><p>Maximum plotting time.  Defaults to upper boundary knot.</p></dd>


<dt>nsim</dt>
<dd><p>Number of simulations to draw</p></dd>


<dt>hq</dt>
<dd><p>Quantiles which define the "low" and "high" values to compute the hazard ratio between.
By default, this is <code>c(0.1, 0.9)</code>, so that the 10\<!-- % and 90\\% quantiles are used -->
respectively.</p></dd>


<dt>quantiles</dt>
<dd><p>Quantiles used to summarise the prior predictive distribution
of the standard deviation.</p></dd>


<dt>X0</dt>
<dd><p>An alternative covariate value (optional).  The hazard ratio between the hazards at X
and X0 will also be returned.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This is done by:</p>
<p>(1) simulating a set of parameters from their prior distributions</p>
<p>(2) computing the hazard at a fine grid of equally-spaced points spanning
the boundary knots</p>
<p>(3) calculating the empirical standard deviation of the set of hazards at
these points</p>
<p>(4) repeatedly performing steps 1-3, and summarising the distribution of the
resulting standard deviations.   This is the implied prior for the hazard
variability.</p>
<p><code>prior_haz_sd</code> computes the SD of the hazard, and the SD of the inverse hazard is also
computed.   The inverse hazard at time t is the expected time to the event given survival to t.
The hazard ratio between a high and low value (defined by quantiles of values at different times)
is also computed.</p>
<p><code>prior_hr_sd</code> computes the SD of the hazard ratio between two covariate values
supplied by the user.</p>
<p>All of these SDs refer to the variability over time, e.g. a SD of 0 indicates that the
hazard (or inverse hazard, or hazard ratio) is constant with time.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Christopher Jackson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

