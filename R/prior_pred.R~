
#' Simulate a dataset from the prior predictive distribution of survival times 
#' in an M-spline survival model
#' 
prior_pred <- function(n, censtime=Inf, 
                       alpha_mean=0, alpha_sd=20, lcoef_mean = NULL, lcoef_sd=1,
                       iknots, bknots, degree=3){
  nsim <- 1
  np <- length(lcoef_mean) + 1
  beta <- matrix(nrow=nsim, ncol=np)
  beta[,1] <- 0
  if (is.null(lcoef_mean))
    lcoef_mean <- mspline_uniform_weights(iknots, bknots, logit=TRUE)
  alpha <- exp(rnorm(nsim, alpha_mean, alpha_sd))
  for (j in 2:np){
    beta[,j] <- rlogis(nsim, lcoef_mean[j-1], lcoef_sd)
  }
  coefs <- exp(beta) / rowSums(exp(beta))
  knots <- c(iknots, bknots)
  sim <- rsurvmspline(n, alpha, coefs, knots, degree=degree)
  data.frame(time = pmin(sim, censtime), event = as.numeric(sim<=censtime))
}	

